---
title: Zuplo Routing
sidebar_label: Routing
---

Zuplo's routing system is designed to be simple and powerful, allowing you to define how requests are handled and processed.

## Routing Basics

Zuplo uses the OpenAPI document to define the routes for your API. Each route is defined by a path and an HTTP method (GET, POST, PUT, DELETE, etc.).

## Path Modes

Zuplo supports two path modes:

- **OpenAPI Mode**: This mode is the default and allows you to define routes
using OpenAPI paths and [path parameters](https://swagger.io/docs/specification/v3_0/describing-parameters/#path-parameters).
- **URL Pattern Mode**: This mode allows you to define routes using the
web-standard [URLPattern](https://developer.mozilla.org/en-US/docs/Web/API/URLPattern).

## Path Matching & Order

Zuplo uses the OpenAPI document to determine how to match incoming requests to the defined routes.

### Route Matching Order

Routes are matched in the order they're defined in the OpenAPI document and the alphabetical order the OpenAPI documents are defined in your project.

### Customizing Route Order

To customize or change the order of route matching within a single OpenAPI file, reorder the path entries in the `paths` object.

For example, if you want `/users/admin` to be matched before `/users/{userId}`, place it first in your `routes.oas.json`:

```json
{
  "paths": {
    "/users/admin": {
      "get": {
        "operationId": "get-admin-user"
      }
    },
    "/users/{userId}": {
      "get": {
        "operationId": "get-user"
      }
    }
  }
}
```

In this example, requests to `/users/admin` will match the first route, while requests to `/users/123` will match the second route.

:::tip

When organizing routes, place more specific paths before more general ones to ensure correct matching.

:::

## Path Parameters

Path parameters are variables in the URL path that can be used to capture dynamic values.

```ts
import { ZuploRequest, ZuploContext } from "@zuplo/runtime";
import { getUserById } from "./userService";

export default async function (request: ZuploRequest, context: ZuploContext) {
  const userId = request.params.userId;
  const user = await getUserById(userId);
  return context.json(user);
}
```

In this example, the `userId` parameter is extracted from the request and used to fetch the user from an external data source or API in the `getUserById` function.

URLPattern mode also supports path parameters, but they're defined using a colon `:` instead of curly braces `{}`.

## Path Matching Examples

### OpenAPI Mode

The example below shows how to define a route in OpenAPI mode with a simple path and `userId` parameter.

```json
{
  "paths": {
    "/users/{userId}": {
      "get": {
        "operationId": "get-user"
      }
    }
  }
}
```

Parameters can be defined anywhere in a path, for example, you could have a path like `/users/{userId}/posts/{postId}`.

Paths don't need to be defined using common REST principles. You are free to structure your paths however you prefer.

:::caution{title="Special Characters"}

The handling of special characters in the path has changed with [Compatibility Date 2025-02-06](../programmable-api/compatibility-dates.md#special-characters-in-openapi-format-urls)

:::

### URL Pattern Mode

The example below shows how to define a route in OpenAPI mode with a simple path and `userId` parameter.

```json
{
  "paths": {
    "/users/:userId": {
      "get": {
        "operationId": "get-user"
      }
    }
  }
}
```

In addition to the simple parameter patterns, you can also use RegEx patterns.

```json
{
  "paths": {
    "/users/(.*)": {
      "get": {
        "operationId": "get-user"
      }
    }
  }
}
```
